##########

stages:
  - test
  - build
  - deploy

variables:
  LC_ALL: "en_US.UTF-8"
  LANG: "en_US.UTF-8"
  GIT_STRATEGY: clone
  GEM_HOME: .vendor/gem_install

before_script:
  - gem install bundler
  - bundle install

# start only on runner with label "macos"
default:
  tags:
    - macos

fastlane-test:
  stage: test
  only:
    - ci_setup
  script:
    - bundle exec fastlane test
  when: manual

fastlane-build-beta:
  stage: build
  only:
    - ci_setup
  script:
    - bundle exec fastlane build production:false
  when: manual

fastlane-deploy:
  stage: deploy
  only:
    - ci_setup
  script:
    - bundle exec fastlane deploy
  when: manual
